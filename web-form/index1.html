<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Colorlib Templates">
    <meta name="author" content="Colorlib">
    <meta name="keywords" content="Colorlib Templates">

    <!-- Title Page-->
    <title>Create Doc by Tuannajaa</title>

    <!-- Icons font CSS-->
    <link href="vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">
    <link href="vendor/font-awesome-4.7/css/font-awesome.min.css" rel="stylesheet" media="all">
    <!-- Font special for pages-->

    <!-- Vendor CSS-->
    <link href="vendor/select2/select2.min.css" rel="stylesheet" media="all">
    <link href="vendor/datepicker/daterangepicker.css" rel="stylesheet" media="all">

    <!-- Main CSS-->
    <link href="css/main.css" rel="stylesheet" media="all">
    <link type="text/css" href="css/checkbox.css" rel="stylesheet" media="all">
    <link type="text/css" href="css/ui-lightness/jquery-ui-1.8.10.custom.css" rel="stylesheet" />

    <style type="text/css">
        .demoHeaders {
            margin-top: 2em;
        }

        #dialog_link {
            padding: .4em 1em .4em 20px;
            text-decoration: none;
            position: relative;
        }

        #dialog_link span.ui-icon {
            margin: 0 5px 0 0;
            position: absolute;
            left: .2em;
            top: 50%;
            margin-top: -8px;
        }

        ul#icons {
            margin: 0;
            padding: 0;
        }

        ul#icons li {
            margin: 2px;
            position: relative;
            padding: 4px 0;
            cursor: pointer;
            float: left;
            list-style: none;
        }

        ul#icons span.ui-icon {
            float: left;
            margin: 0 4px;
        }

        ul.test {
            list-style: none;
            line-height: 30px;
        }
    </style>



</head>

<body>
    <div class="page-wrapper bg-gra-02 p-t-130 p-b-100 font-poppins">
        <div class="wrapper wrapper--w680">
            <div class="card card-4">
                <div class="card-body">
                    <h2 class="title">-ออกหนังสือยินยอมให้บุตรเดินทางไปต่างประเทศ</h2>
                    <form method="POST">
                        <div class="row row-space">
                            <div class="" style="width: 100%;">

                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="" style="width: 100%;">
                                    <div class="input-group">
                                        <label class="label">เจ้าหน้าที่ดำเนินการ</label>
                                        <select class="input--style-4" name="officer" id="officer">
                                            <option value="เจ้าหน้าที่">กรุณาเลือกเจ้าหน้าที่ดำเนินการ</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">เลขที่หนังสือ</label>
                                    <input class="input--style-4" type="text" name="docNo" id="docNo">
                                </div>
                            </div>
                        </div>
                        <hr noshade=""><br>
                        <div class="row row-space">
                            <div class="col-2">
                            <button class="btn btn--radius-2 btn--blue" style="background-color: rgb(73, 1, 255);" type="button"
                                onclick="getCardData()" >ดึงข้อมูลจากบัตรประชาชน</button>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">สำนักทะเบียนท้องถิ่น ที่ออกบัตร</label>
                                    <input class="input--style-4" type="text" name="cardplace" id="cardplace" >
                                </div>
                            </div>    
                        </div>
                        <br>
                        <div class="row row-space">
                            <div class="" style="width: 100%;">
                                <div class="input-group">
                                    <label class="label">ชื่อ-สกุล ผู้ร้อง <b>(พ่อ)</b></label>
                                    <input class="input--style-4" type="text" name="full_name" id="full_name">
                                </div>
                            </div>
                        </div>
                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">วัน/เดือน/ปี/เกิด</label>
                                    <div class="input-group-icon">
                                        <input type="text" class="datepicker-th-2" id="birthday" name="date1"
                                            value="ClickHere" />
                                        <i class="zmdi zmdi-calendar-note input-icon js-btn-calendar"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">จังหวัดที่เกิด</label>
                                    <input class="input--style-4" type="text" name="birth_province" id="birth_province">
                                </div>
                            </div>

                        </div>


                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ชื่อบิดา</label>
                                    <input class="input--style-4" type="text" name="father" id="father">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ชื่อมารดา</label>
                                    <input class="input--style-4" type="text" name="mother" id="mother">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">อยู่บ้านเลขที่</label>
                                    <input class="input--style-4" type="text" name="addresss" id="addresss">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">หมู่ที่</label>
                                    <input class="input--style-4" type="text" name="moo" id="moo">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ตรอก/ซอย/ถนน</label>
                                    <input class="input--style-4" type="text" name="road" id="road">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ตำบล/แขวง</label>
                                    <input class="input--style-4" type="text" name="tambol" id="tambol">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">อำเภอ/เขต</label>
                                    <input class="input--style-4" type="text" name="district" id="district">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">จังหวัด</label>
                                    <input class="input--style-4" type="text" name="provice" id="provice">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">อาชีพ</label>
                                    <input class="input--style-4" type="text" name="job" id="job">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">บัตรประจำตัวประชาชน</label>
                                    <input class="input--style-4" type="number" name="card" id="card">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">วันออกบัตร</label>
                                    <div class="input-group-icon">
                                        <input class="datepicker-th-2" type="text" name="init-card" id="init-card"
                                            value="ClickHere">
                                        <i class="zmdi zmdi-calendar-note input-icon js-btn-calendar"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">บัตรหมดอายุ</label>
                                    <div class="input-group-icon">
                                        <input class="datepicker-th-2" type="text" name="exp-card" id="exp-card"
                                            value="ClickHere">
                                        <i class="zmdi zmdi-calendar-note input-icon js-btn-calendar"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ต้องการออกหนังสือรับรองเพื่อ..</label>
                                    <input class="input--style-4" type="text" name="forwhat" id="forwhat">
                                </div>
                            </div>
                        </div>
                        <hr noshade=""><br>
                        <h3>ข้อมูลทะเบียนสมรส และ ทะเบียนการหย่า (ไม่มีไส่ขีด -)</h3>
                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ทะเบียนสมรส เลขที่</label>
                                    <input class="input--style-4" type="text" name="mariedcard" id="mariedcard">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">(สมรส)ออกให้โดยสำนักทะเบียน</label>
                                    <input class="input--style-4" type="text" name="mcardfrom" id="mcardfrom">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">(สมรส)อำเภอ/เขต ที่ออก</label>
                                    <input class="input--style-4" type="text" name="mcard_district" id="mcard_district">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">(สมรส)จังหวัดที่ออก</label>
                                    <input class="input--style-4" type="text" name="mcard_province" id="mcard_province">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">(สมรส)วันที่ออกใบสมรส</label>
                                    <input class="input--style-4" type="text" name="mcard_date" id="mcard_date">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ทะเบียนการหย่า เลขที่</label>
                                    <input class="input--style-4" type="text" name="divorcecard" id="divorcecard">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">(หย่า) ออกให้โดยสำนักทะเบียน</label>
                                    <input class="input--style-4" type="text" name="dcardfrom" id="dcardfrom">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">(หย่า)อำเภอ/เขต ที่ออก</label>
                                    <input class="input--style-4" type="text" name="dcard_district" id="dcard_district">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">(หย่า)จังหวัดที่ออก</label>
                                    <input class="input--style-4" type="text" name="dcard_province" id="dcard_province">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">(หย่า)วันที่ออกใบหย่า</label>
                                    <input class="input--style-4" type="text" name="dcard_date" id="dcard_date">
                                </div>
                            </div>
                        </div>

                        <hr noshade=""><br>
                        <div class="row row-space">
                            <div class="col-2">
                            <button class="btn btn--radius-2 btn--blue" style="background-color: rgb(73, 1, 255);" type="button"
                                onclick="getCardDataMom()" >ดึงข้อมูลจากบัตรประชาชน</button>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">สำนักทะเบียนท้องถิ่น ที่ออกบัตร</label>
                                    <input class="input--style-4" type="text" name="cardplace_mom" id="cardplace_mom" >
                                </div>
                            </div>    
                        </div>
                        <div class="row row-space">
                            <div class="" style="width: 100%;">
                                <div class="input-group">
                                    <label class="label">ชื่อ-สกุล ผู้ร้อง <b>(แม่)</b></label>
                                    <input class="input--style-4" type="text" name="full_name_mom" id="full_name_mom">
                                </div>
                            </div>
                        </div>
                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">วัน/เดือน/ปี/เกิด</label>
                                    <div class="input-group-icon">
                                        <input class="datepicker-th-2" type="text" name="birthday_mom" id="birthday_mom"
                                            value="ClickHere">
                                        <i class="zmdi zmdi-calendar-note input-icon js-btn-calendar"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">จังหวัดที่เกิด</label>
                                    <input class="input--style-4" type="text" name="birth_province_mom"
                                        id="birth_province_mom">
                                </div>
                            </div>
                        </div>


                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ชื่อบิดา</label>
                                    <input class="input--style-4" type="text" name="father_mom" id="father_mom">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ชื่อมารดา</label>
                                    <input class="input--style-4" type="text" name="mother_mom" id="mother_mom">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <input type="button" class="copydata" id="copydata"
                                    value="&#x2611; ที่อยู่เดียวกับพ่อ หรือ Scanบัตร" onClick="copy();"
                                    style="border: 2px solid rgb(255, 82, 47);" />
                            </div>
                            <div class="col-2">

                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">อยู่บ้านเลขที่</label>
                                    <input class="input--style-4" type="text" name="addresss_mom" id="addresss_mom">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">หมู่ที่</label>
                                    <input class="input--style-4" type="text" name="moo_mom" id="moo_mom">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ตรอก/ซอย/ถนน</label>
                                    <input class="input--style-4" type="text" name="road_mom" id="road_mom">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ตำบล/แขวง</label>
                                    <input class="input--style-4" type="text" name="tambol_mom" id="tambol_mom">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">อำเภอ/เขต</label>
                                    <input class="input--style-4" type="text" name="district_mom" id="district_mom">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">จังหวัด</label>
                                    <input class="input--style-4" type="text" name="provice_mom" id="provice_mom">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">อาชีพ</label>
                                    <input class="input--style-4" type="text" name="job_mom" id="job_mom">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">บัตรประจำตัวประชาชน</label>
                                    <input class="input--style-4" type="number" name="card_mom" id="card_mom">
                                </div>
                            </div>
                        </div>

                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">วันออกบัตร</label>
                                    <div class="input-group-icon">
                                        <input class="datepicker-th-2" type="text" name="init-card_mom"
                                            id="init-card_mom" value="Click Here">
                                        <i class="zmdi zmdi-calendar-note input-icon js-btn-calendar"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">บัตรหมดอายุ</label>
                                    <div class="input-group-icon">
                                        <input class="datepicker-th-2" type="text" name="exp-card_mom" id="exp-card_mom"
                                            value="Click Here">
                                        <i class="zmdi zmdi-calendar-note input-icon js-btn-calendar"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <hr noshade=""><br>
                        <h3>ข้อมูลบุตร</h3>
                        <div class="row row-space">
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">ชื่อ-สกุล ลูก</label>
                                    <input class="input--style-4" type="text" name="full_name_son" id="full_name_son">
                                </div>
                            </div>
                            <div class="col-2">
                                <div class="input-group">
                                    <label class="label">บัตรประจำตัวประชาชน</label>
                                    <input class="input--style-4" type="number" name="card_son" id="card_son">
                                </div>
                            </div>
                        </div>


                        <div class="row row-space">
                            <div class="p-t-15">
                                <button class="btn btn--radius-2 btn--blue" type="button"
                                    onclick="generate()" onmouseover="validation_index1()">Submit</button>
                            </div>
                            <div class="p-t-15">
                                <button class="btn btn--radius-2 btn--blue" type="button"
                                    onclick="location.href='https://pokkrong-2409a.web.app/index.html'"
                                    style="background: darkmagenta">Back</button>
                            </div>
                        </div>
                    </form>

                </div>
            </div>
        </div>
    </div>

    <!-- Jquery JS-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <!-- Thai Carlendar Format-->
    <script type="text/javascript" src="js/jquery-1.4.4.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.8.10.offset.datepicker.min.js"></script>
    <!-- CheckBox SameData-->
    <script type="text/javascript" src="js/checkbox.js"></script>
    <script type="text/javascript">
        $(function () {
            var d = new Date();
            var toDay = d.getDate() + '/' + (d.getMonth() + 1) + '/' + (d.getFullYear() + 543);

            // กรณีต้องการใส่ปฏิทินลงไปมากกว่า 1 อันต่อหน้า ก็ให้มาเพิ่ม Code ที่บรรทัดด้านล่างด้วยครับ (1 ชุด = 1 ปฏิทิน)

            $(".datepicker-th-2").datepicker({
                changeMonth: true, changeYear: true, dateFormat: 'dd/mm/yy', isBuddhist: true, defaultDate: toDay, dayNames: ['อาทิตย์', 'จันทร์', 'อังคาร', 'พุธ', 'พฤหัสบดี', 'ศุกร์', 'เสาร์'],
                dayNamesMin: ['อา.', 'จ.', 'อ.', 'พ.', 'พฤ.', 'ศ.', 'ส.'],
                monthNames: ['มกราคม', 'กุมภาพันธ์', 'มีนาคม', 'เมษายน', 'พฤษภาคม', 'มิถุนายน', 'กรกฎาคม', 'สิงหาคม', 'กันยายน', 'ตุลาคม', 'พฤศจิกายน', 'ธันวาคม'],
                monthNamesShort: ['ม.ค.', 'ก.พ.', 'มี.ค.', 'เม.ย.', 'พ.ค.', 'มิ.ย.', 'ก.ค.', 'ส.ค.', 'ก.ย.', 'ต.ค.', 'พ.ย.', 'ธ.ค.']
            });

        });
    </script>
    <!-- Vendor JS-->
    <script src="vendor/select2/select2.min.js"></script>
    <script src="vendor/datepicker/moment.min.js"></script>
    <script src="vendor/datepicker/daterangepicker.js"></script>

    <!-- Main JS-->
    <script src="js/global.js"></script>
    <!--Copy Same Address Data-->
    <script type="text/javascript">
        function copy() {
            var a1 = document.getElementById("addresss");
            var a2 = document.getElementById("addresss_mom");
            a2.value = a1.value;
            var b1 = document.getElementById("moo");
            var b2 = document.getElementById("moo_mom");
            b2.value = b1.value;
            var c1 = document.getElementById("road");
            var c2 = document.getElementById("road_mom");
            c2.value = c1.value;
            var d1 = document.getElementById("tambol");
            var d2 = document.getElementById("tambol_mom");
            d2.value = d1.value;
            var e1 = document.getElementById("district");
            var e2 = document.getElementById("district_mom");
            e2.value = e1.value;
            var f1 = document.getElementById("provice");
            var f2 = document.getElementById("provice_mom");
            f2.value = f1.value;
            document.getElementById("copydata").disabled = true;
        }

    </script>

</body><!-- This templates was made by Colorlib (https://colorlib.com) -->

<script src="js/docxtemplater.js"></script>
<script src="js/jszip.js"></script>
<script src="js/FileSaver.js"></script>
<script src="js/jszip-utils.js"></script>
<!--
<script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.9.1/docxtemplater.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.6.1/jszip.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip-utils/0.0.2/jszip-utils.js"></script>
-->
<!--
    Mandatory in IE 6, 7, 8 and 9.
    -->
<!--[if IE]>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip-utils/0.0.2/jszip-utils-ie.js"></script>
    <![endif]-->
<script>
    function loadFile(url, callback) {
        JSZipUtils.getBinaryContent(url, callback);
    }

    function generate() {

        loadFile("https://pokkrong-2409a.web.app/basedoc/KidGoAbroad.docx", function (error, content) {
            if (error) {
                throw error
            };
            var zip = new JSZip(content);
            var doc = new window.docxtemplater().loadZip(zip)
            //ตัวแปร วัน เดือน ปี เกิด พ่อ
            var birthday_v = document.getElementById("birthday").value.split("/");
            var birthday_v2 = document.getElementById("birthday").value;
            var b_date = parseInt(birthday_v[0]);
            var b_month = parseInt(birthday_v[1]);
            var b_year = birthday_v[2];
            var b_year_int = parseInt(b_year);
            //ตัวแปร วัน เดือน ปี เกิด แม่
            var birthday_v_mom = document.getElementById("birthday_mom").value.split("/");
            var birthday_v2_mom = document.getElementById("birthday_mom").value;
            var b_date_mom = parseInt(birthday_v_mom[0]);
            var b_month_mom = parseInt(birthday_v_mom[1]);
            var b_year_mom = birthday_v_mom[2];
            var b_year_int_mom = parseInt(b_year_mom);

            //ตัวแปรวันที่ปัจจุบัน 
            var to_day = new Date();
            var thmonth = new Array("มกราคม", "กุมภาพันธ์", "มีนาคม", "เมษายน", "พฤษภาคม", "มิถุนายน", "กรกฎาคม", "สิงหาคม", "กันยายน", "ตุลาคม", "พฤศจิกายน", "ธันวาคม");
            var dd = to_day.getDate();
            var mm = to_day.getMonth();
            var mmmm = parseInt(mm) + 1;
            var yy = to_day.getFullYear();
            var yyyy = to_day.getFullYear() + 543;
            var mmm = thmonth[to_day.getMonth()];
            var this_day = dd + ' ' + mmm + ' ' + yyyy;

            //วันออกบัตร พ่อ
            var issue_c = document.getElementById("init-card").value.split("/");
            var issue_date = parseInt(issue_c[0]);
            var issue_month = issue_c[1];
            var issue_year = issue_c[2];
            var issue_m = parseInt(issue_month);
            var issue_year_int = parseInt(issue_year);
            var issue_mm = thmonth[issue_m - 1];
            var issue_card = issue_date + ' ' + issue_mm + ' ' + issue_year_int;

            //วันออกบัตร แม่
            var issue_c_mom = document.getElementById("init-card_mom").value.split("/");
            var issue_date_mom = parseInt(issue_c_mom[0]);
            var issue_month_mom = issue_c_mom[1];
            var issue_year_mom = issue_c_mom[2];
            var issue_m_mom = parseInt(issue_month_mom);
            var issue_year_int_mom = parseInt(issue_year_mom);
            var issue_mm_mom = thmonth[issue_m_mom - 1];
            var issue_card_mom = issue_date_mom + ' ' + issue_mm_mom + ' ' + issue_year_int_mom;

            //วันบัตรหมดอายุ พ่อ
            var exp_c = document.getElementById("exp-card").value.split("/");
            var exp_date = parseInt(exp_c[0]);
            var exp_month = parseInt(exp_c[1]);
            var exp_year = parseInt(exp_c[2]);
            var exp_mm = thmonth[exp_month - 1];
            if(exp_year==9999){
                    var exp_card ="ตลอดชีพ"
                    }
                else{
                    var exp_card = exp_date + ' ' + exp_mm + ' ' + exp_year;
                }
            //วันบัตรหมดอายุ แม่
            var exp_c_mom = document.getElementById("exp-card_mom").value.split("/");
            var exp_date_mom = parseInt(exp_c_mom[0]);
            var exp_month_mom = parseInt(exp_c_mom[1]);
            var exp_year_mom = parseInt(exp_c_mom[2]);
            var exp_mm_mom = thmonth[exp_month_mom - 1];
            if(exp_year_mom==9999){
                    var exp_card_mom ="ตลอดชีพ"
                    }
                else{
                    var exp_card_mom = exp_date_mom + ' ' + exp_mm_mom + ' ' + exp_year_mom;
                }
            

            //AGE BY BIRTHDATE
            //คำนวนอายุอัตโนมัติ พ่อ
            var age_in_years;
            if (b_month > mmmm) { age_in_years = (yyyy - b_year_int) - 1; }
            if (b_month < mmmm) { age_in_years = yyyy - b_year_int; }
            if (b_month == mmmm) {
                if (b_date <= dd) { age_in_years = yyyy - b_year_int; }
                else age_in_years = (yyyy - b_year_int) - 1;
            }

            //คำนวนอายุอัตโนมัติ แม่
            var age_in_years_mom;
            if (b_month_mom > mmmm) { age_in_years_mom = (yyyy - b_year_int_mom) - 1; }
            if (b_month_mom < mmmm) { age_in_years_mom = yyyy - b_year_int_mom; }
            if (b_month_mom == mmmm) {
                if (b_date_mom <= dd) { age_in_years_mom = yyyy - b_year_int_mom; }
                else age_in_years_mom = (yyyy - b_year_int_mom) - 1;
            }




            //ใส่ขีดให้เลขบัตรประชาชน พ่อ
            var id_card = document.getElementById('card').value;
            var id_card_slice = id_card.substring(0, 1) + '-' + id_card.substring(1, 5) + '-' + id_card.substring(5, 10) + '-' + id_card.substring(10, 12) + '-' + id_card.substring(12, 13);
            //ใส่ขีดให้เลขบัตรประชาชน แม่
            var id_card_mom = document.getElementById('card_mom').value;
            var id_card_slice_mom = id_card_mom.substring(0, 1) + '-' + id_card_mom.substring(1, 5) + '-' + id_card_mom.substring(5, 10) + '-' + id_card_mom.substring(10, 12) + '-' + id_card_mom.substring(12, 13);
            //ใส่ขีดให้เลขบัตรประชาชน ลูก
            var id_card_son = document.getElementById('card_son').value;
            var id_card_slice_son = id_card_son.substring(0, 1) + '-' + id_card_son.substring(1, 5) + '-' + id_card_son.substring(5, 10) + '-' + id_card_son.substring(10, 12) + '-' + id_card_son.substring(12, 13);

            //หากมีการ input เลขที่ใบหย่า ให้ใส่ชื่อคู่สมรสที่จดหย่า

            if (document.getElementById("divorcecard").value !== '-') {
                var couple_m = document.getElementById("full_name").value;
                var couple_fm = document.getElementById("full_name_mom").value;
            }
            else {
                var couple_m = '-';
                var couple_fm = '-';
            }
            //ดำเนินการเรื่องอะไร
            const titleName = document.getElementsByTagName('h2')[0].innerHTML




            doc.setData({
                //ตัวแปรข้อมูลพ่อ
                full_name: document.getElementById("full_name").value,
                b_date: b_date,
                b_month: b_month,
                b_year: b_year_int,
                tday: this_day,
                birth_province: document.getElementById("birth_province").value,
                age: age_in_years,
                father: document.getElementById("father").value,
                mother: document.getElementById("mother").value,
                addresss: document.getElementById("addresss").value,
                moo: document.getElementById("moo").value,
                road: document.getElementById("road").value,
                tambol: document.getElementById("tambol").value,
                district: document.getElementById("district").value,
                provice: document.getElementById("provice").value,
                job: document.getElementById("job").value,
                card: id_card_slice,
                officer: document.getElementById("officer").value,
                init_card: issue_card,
                exp_card: exp_card,
                forwhat: document.getElementById("forwhat").value,
                yyyy: yyyy,
                titleName:titleName,
                //เลขที่หนังสือ
                docNo: document.getElementById("docNo").value,
                cardplace: document.getElementById("cardplace").value,
                cardplace_mom: document.getElementById("cardplace_mom").value,

                //ตัวแปรข้อมูลสมรสและหย่า
                mariedcard: document.getElementById("mariedcard").value,
                mcardfrom: document.getElementById("mcardfrom").value,
                mcard_district: document.getElementById("mcard_district").value,
                mcard_province: document.getElementById("mcard_province").value,
                mcard_date: document.getElementById("mcard_date").value,
                divorcecard: document.getElementById("divorcecard").value,
                dcardfrom: document.getElementById("dcardfrom").value,
                dcard_district: document.getElementById("dcard_district").value,
                dcard_province: document.getElementById("dcard_province").value,
                dcard_date: document.getElementById("dcard_date").value,
                couple_fm: couple_fm,
                couple_m: couple_m,

                //ตัวแปรข้อมูลแม่
                full_name_mom: document.getElementById("full_name_mom").value,
                birth_province_mom: document.getElementById("birth_province_mom").value,
                father_mom: document.getElementById("father_mom").value,
                mother_mom: document.getElementById("mother_mom").value,
                addresss_mom: document.getElementById("addresss_mom").value,
                moo_mom: document.getElementById("moo_mom").value,
                road_mom: document.getElementById("road_mom").value,
                tambol_mom: document.getElementById("tambol_mom").value,
                district_mom: document.getElementById("district_mom").value,
                provice_mom: document.getElementById("provice_mom").value,
                job_mom: document.getElementById("job_mom").value,
                card_mom: id_card_slice_mom,
                init_card_mom: issue_card_mom,
                exp_card_mom: exp_card_mom,
                b_year_mom: b_year_int_mom,
                age_mom: age_in_years_mom,

                //ตัวแปรข้อมูลลูก
                full_name_son: document.getElementById("full_name_son").value,
                card_son: id_card_slice_son

            });
            try {
                // render the document (replace all occurences of {first_name} by John, {last_name} by Doe, ...)
                doc.render()
            } catch (error) {
                var e = {
                    message: error.message,
                    name: error.name,
                    stack: error.stack,
                    properties: error.properties,
                }
                console.log(JSON.stringify({
                    error: e
                }));
                // The error thrown here contains additional information when logged with JSON.stringify (it contains a property object).
                throw error;
            }
            var out = doc.getZip().generate({
                type: "blob",
                mimeType: "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
            }) //Output the document using Data-URI
            saveAs(out, "output.docx")

        })
    }
</script>

<script src="js/validation.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.10.1/dist/sweetalert2.all.min.js"></script>
<script src="js/officer.js"></script>
<script src="js/getCardDataVer2.js"></script>
</html>